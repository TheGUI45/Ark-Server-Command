# Ark-Server-Command
ASA Server Manager (Ark Survival Ascended)
================================================

Overview
--------
Local, secure Electron + React application to manage ASA dedicated servers: install/update server, manage mods, clusters, INI files, backups, and graceful shutdown countdown.

Runtime Architecture
--------------------
- Main Process: `src/main/main.ts` compiled to `dist/main/main.js` (Electron entry point).
- Preload: `src/preload/index.ts` exposes a tightly scoped `window.api`.
- Renderer: React UI under `src/renderer/` served by Vite in dev or loaded from `dist/renderer/` in production.
- Services: SteamCMD, Mods, Backups, INI, Profiles, RCON/Shutdown.

Dev Workflow
------------
1. Install deps:
   ```powershell
   npm install
   ```
2. (Optional) Choose a dev port (default 5183). Example:
   ```powershell
   $env:DEV_PORT=5193
   ```
3. Start watchers + Electron:
   ```powershell
   npm run dev
   ```
   This runs TypeScript watchers (main & preload), Vite (renderer) and then the Electron process once `dist/main/main.js` and the dev server URL are reachable.

If the dev window is not launching:
----------------------------------
- Ensure no stale Vite/Electron processes occupy the port:
  ```powershell
  Stop-Process -Name electron -ErrorAction SilentlyContinue
  Stop-Process -Name node -ErrorAction SilentlyContinue
  $p=(Get-NetTCPConnection -LocalPort $env:DEV_PORT -State Listen -ErrorAction SilentlyContinue | Select-Object -First 1).OwningProcess; if($p){ Stop-Process -Id $p -Force }
  npm run dev
  ```
- Confirm `dist/main/main.js` exists (it is generated by the main TS watcher). If absent, check for TypeScript errors.
- The concurrency script may race; if needed run manually:
  ```powershell
  # Separate terminals or background jobs:
  npm run dev:main
  npm run dev:preload
  $env:DEV_PORT=5183; npm run dev:renderer
  # Once renderer URL is serving and main/preload compiled:
  $env:VITE_DEV_SERVER_URL="http://127.0.0.1:$env:DEV_PORT"; electron .
  ```

Configurable Port
-----------------
Set `DEV_PORT` (or `VITE_PORT`) before `npm run dev`. Vite reads `process.env.DEV_PORT || process.env.VITE_PORT || 5183`.

Production Build / Executable
-----------------------------
1. Build assets:
   ```powershell
   npm run build
   ```
2. Package (creates installer / unpacked app):
   ```powershell
   npm run dist
   ```
3. Resulting artifacts (Windows):
   - Installer: `dist/ASA Server Manager-0.1.0-win.exe` (NSIS)
   - Unpacked directory: `dist/win-unpacked/ASA Server Manager.exe`

For macOS / Linux respective artifacts appear under `dist/` (dmg / AppImage).

Graceful Shutdown
-----------------
Use Servers > Shutdown tab. Provide RCON host/port/password and countdown seconds. The app broadcasts milestones, saves world, and sends `DoExit`.

Backups
-------
Define jobs (source/target inside workspace root). Optional CRON schedule. Retention keeps newest N archives.

SteamCMD / Server Update
------------------------
Workspace root + steamcmd directory must be set in Settings. Install/update uses AppID 2430930 (ASA dedicated server). Mods use Workshop AppID 2399830 by default.

Security Practices
------------------
- No Node integration in renderer; sandboxed window.
- IPC surface explicitly whitelisted.
- Paths restricted to workspace root.
- CSP blocks remote code.

Troubleshooting Quick List
--------------------------
- Port conflicts: kill stale processes or change `$env:DEV_PORT`.
- Missing executable: run `npm run dist` to generate platform installers.
- Blank window in dev: ensure `VITE_DEV_SERVER_URL` set (handled automatically by start script) and renderer built.
- RCON failures: verify GameUserSettings.ini has `RCONEnabled=True`, matching port, and password.

Next Steps
----------
- Server lifecycle UI (start/stop logs)
- Enhanced INI schema editing/validation
- Update service for server version checks
- Automated cluster transfer management
# Claude AI Integration
## CurseForge Mod Suggestions
While typing in the CurseForge Query field (≥2 characters, API key set, Online mode), a live suggestion list appears:
- Up to 8 lightweight results (debounced ~260ms) showing name + summary snippet.
- Navigate with Arrow Up/Down and press Enter to select; or click with the mouse.
- Selecting a suggestion auto-populates the query and runs a full search.
- Escape closes the list; focusing away hides it after a short delay.

Graceful Degradation:
- Offline Mode or missing API key disables suggestions automatically.
- Errors during suggestion fetch silently clear the list without interrupting typing.

The app includes optional Claude (Anthropic) integration for administrative assistance and mod management brainstorming.

Enabling Claude:
1. Obtain an Anthropic API key with access to the desired Sonnet model.
2. Open Settings > Claude AI.
3. Check "Enable Claude Integration" and paste your API key.
4. (Optional) Adjust the model override (default: `claude-sonnet-4.5`).
5. Save Settings.
6. Open the "Claude AI" panel to run single completions or live streaming responses.

Features:
- Single response (`Complete`) or streaming tokens (`Stream`).
- System prompt customization per session.
- Local-only key storage; never logged or transmitted beyond Anthropic API.
- Offline Mode instantly blocks all Claude requests.

Basic Rate Limiting:
- Up to 20 calls per minute (shared between complete + stream) to prevent runaway usage.

Security Notes:
- API key stored in `settings.json` in the Electron userData directory.
- No key exposure in renderer state once saved (input cleared only for Web API token; Claude key remains but can be replaced).
- Errors truncate remote messages to 400 chars for safety.

# ASA Server Manager (Electron)

Secure, cross‑platform desktop app to manage Ark Survival Ascended dedicated servers. No paywalls.

## Dev Setup
```powershell
npm install
npm run dev
```

## SteamCMD (Install/Update)
- The app provides a secure SteamCMD wrapper. Paths are validated inside a workspace root you choose.
- For a quick smoke test in dev UI, click "Install/Update ASA (Dev Test)".

## Packaging
```powershell
npm run dist
```
